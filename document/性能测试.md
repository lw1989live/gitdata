# 全栈性能测试修炼宝典JMeter实战（陈志勇）
# 目录
## 基础篇
## 第1章　性能方向职业发展　1
### 1．1　为什么选择软件测试　2
### 1．2　软件测试痛处　2
(1) 需求难以驾驭
(2) 岗位处在工作流末端
### 1．3　软件测试发展路线　3
我们可以暂且把软件测试职业路线分为3个方向，分别是业务路线、技术路线、管理路线；
4个象限，分别为执行层、中层、中高层过渡、高层。
（1）业务路线
　　常见业务路线的职位有QA经理、业务专家、产品经理、产品总监、行业咨询顾问等。
（2）技术路线
　　掌握编程技术，拥有业务经验，成为自动化测试工程师、性能测试工程师、软件开发工程师、安全测试工程师、系统分析师、测试总监、研发总监等。
（3）管理路线
　　积累业务知识或者提高技术储备，能够出色地完成本职工作，负责带领团队；岗位一般有测试leader、测试主管、测试经理及测试总监。

　执行层：
1 软件测试--功能（初级--专职过渡阶段）
2 软件测试--性能（专职）
3 软件测试--自动化（专职）
4 软件测试--安全（专职）
5 软件测试--白盒（专职）
6 软件测试--业务（专职）
7 软件测试--小组长、主管（管理路线）
8 软件开发（专职）
9 质量保证工程师SQA（专职--业务线）

　　中层：中级执行管理领导
1 测试分析师（专职--领导过渡阶段）
2 测试架构师初级（专职--领导过渡阶段）
3 测试经理（执行领导--管理路线）
4 QA经理（执行领导--技术路线）
5 产品经理（执行领导--业务线）
6 项目经理（执行领导--技术路线）
7 系统分析师
8 测试培训师

　　中高层过渡：
1 测试总监（执行领导--高级领导）
2 产品总监（业务路线）
3 行业咨询顾问（业务路线）
4 研发总监（技术路线）
5 项目总监（技术路线）

　　高层：
1 CQO--首席质量官
2 CTO--首席技术官
3 CIO--首席信息官
4 CEO--首席执行官
### 1．4　不仅仅是性能测试　4
软件测试还需要具备的能力
（1）需求
（2）代码
（3）运维
### 1．5　从招聘要求看岗位价值　5
### 1．6　性能测试技能树　8
职位技术要求
	测试工具
		Jmeter
		LoadRunner
	测试基础
		性能测试理论
		自动化测试理论
		测试开发
	服务器性能诊断
		CPU
		磁盘
		内存
		网络
	优化技能
		代码
		架构
		中间件
		操作系统
		数据库
			SQL
			配置
			设计
	协议
		HTTP/HTTPS
		WebSocket/Socket
		WebService
		其他RPC实现
	自动化
		接口自动化
		Web自动化
		移动App自动化
	持续集成
		Jenkins
		Maven/Ant
		Git/SVN
#### 1．6．1　测试工具　8
常见难点
1 用户和业务模型分析搭建
2 合适的脚本开发（大部分初学者不根据用户和业务模型来开发脚本，认为要回归成功即可）
3 合适的需求分析转化为场景设计（大部分初学者不知道如何根据需求进行场景设计）
4 大容量系统的数据生成和使用
5 大型系统的性能压力负载和实施
6 云计算的负载生成和实施
#### 1．6．2　测试基础　9
常见难点
1 评估需求
2 负载建模（用户与业务模型）
3 性能压力生成的原理和并发等之间的关系
4 性能测试用例
5 新系统需求分析
6 容量规划
7 性能测试策略
#### 1．6．3　代码　10
推荐使用java、python
#### 1．6．4　服务器性能诊断知识　10
1 Linux
2 windows server
3 oracle
4 mysql
5 Nosql--非关系型数据库
  1 键值数据库--redis
  2 列数据库--cassandra
  3 文档型数据库--mongoDB、couchdb

常见难点：
 1 进程、线程任务之间的区别？
 2 线程中断优先和原理
 3 进程的生命周期
 4 上下文切换
 5 I/O密集型和cpu密集型工作负载之间有什么区别？
 6 生产环境和测试环境之间换算？
 7 事务数据库和分析数据库的使用
 8 数据关系建模和设计
 9 TOP N SQL诊断和优化（执行路径、索引和表链接优化等）？
10 阻击和根治阻塞和死锁？
11 热点防范和定位优化
12 业务数据批量缓存化、异步化
13 数据库配置优化？
#### 1．6．5　性能调优技能　12
很多人说性能测试最难的就是定位性能瓶颈。
常见难点
1 系统硬件资源（CPU、网络、内存、IO）相互之间的关系及原理
2 选择可靠性能指标及指标之间的关联和判定方法
3 永不宕机的实现原理和常见错误
4 排队系统与延迟及缓存的优化关系
5 优化的成本和性价比
6 业务优化的操作实施
7 多系统串联原理及测试隔离
#### 1．6．6　自动化/持续集成　13
当下流行的持续集成工具：Jenkins、Git/SVN、Maven、Ant等；
#### 1．6．7　云计算及虚拟化　13
### 1．7　本章小结　13
## 第2章　性能测试初体验　14
	性能测试是一项综合性工作，致力于暴露性能问题，评估系统性能趋势。
### 2．1　性能测试的价值　15
软件测试分类
	测试方法
		白盒测试
		黑盒测试
		探索性测试
	程序运行状态
		静态测试
		动态测试
	软件阶段
		单元测试
		集成测试
		系统测试
		验收测试
		回归测试
		Alpha测试
		Beta测试
	服务类型
		B/S
		C/S
	测试内容
		功能测试
		负载测试 ○
		压力测试 ○
		性能测试 ○
		大数据测试 ○
		易用性测试
		安装测试
		恢复测试 ○
		安全性测试
		兼容性测试
		内存泄漏测试 ○
		竞品测试 ○
		可靠性测试 ○
		文档测试
	服务类型
		手机端测试
		PC端测试

　从图中可以看出，性能测试在整个软件测试环节中占了50%的内容，比如负载测试、压力测试、性能测试、大数据量测试、恢复测试、内容泄露测试、竞品测试（比较测试）和可靠性测试。
### 2．2　性能测试流程　17
性能测试常规流程图
Start
	↓
学习业务	→	分析需求									END
			↓											↑
设计模型	←	工作评估									编写报告汇报工作
	↓			 										↑Y
┌→编写计划			↓─	─	─	┐N			系统调优	←N	准出检查
N	↓	  ┌→	开发脚本		─┐	│				↓			↑
└	评审	─Y├→	准备测试环境	←┼→	Check	Y→	执行测试	→	分析性能汇报工作
		  └→	准备测试数据	─┘	│				↓
					↑─	─	─	┘N			管理缺陷

（1）业务学习：通过查看文档，手动操作系统来来了解系统性能；
（2）需求分析：分析系统非功能需求，圈定性能测试的范围，了解系统的性能指标；
（3）工作评估：工作量分解，评估工作量，计划资源投入（即需要多少人力，多少工作日来完成性能测试工作）；
（4）设计模型：圈定性能测试范围后，把业务模型映射成测试模型；
（5）计划编写：计划测试工作，在文档中明确列出测试范围、人力投入、持续时间、工作内容、风险评估、风险应对策略等
（6）脚本开发：录制或者编写性能测试脚本，开发测试挡板程序，开发测试程序等；
（7）测试环境准备：性能测试环境准备包括服务器与负载机两部分，服务器是被测系统的运行平台，负载机是我们用来生产负载的机器，用来安装负载工具，运行测试脚本；
（8）测试数据准备：根据测试模型来准备被测系统的主数据与业务数据；
（9）测试执行
（10）缺陷管理：对性能测试过程中发现的缺陷进行管理；
（11）性能分析：对性能测试过程中暴露出来的问题进行分析，找出原因；
（12）性能调优：性能测试人员与开发人员一起来解决性能问题；
（13）测试报告：测试工作的重要交付文件，对测试结果进行报告，主要包括性能指标说明（tps、rt、cpu等）；
	性能测试主要交付件：
	1 测试计划
	2 测试脚本
	3 测试程序
	4 测试报告或者阶段性测试报告
（14）评审：对性能报告中的内容进行评审，确认问题，评估上线风险。
### 2．3　性能测试成功与失败要素　18
性能测试有几大难点：
(1)需求分析
　　对性能测试进行需求分析，通常情况下测试人员会直接依赖需求人员或者项目经理的口述或者有缺陷的文档。实际上，大多数情况下我们测试人员需要自己来引导相关的运维人员和需求人员给出具体的需求数据，并对这些数据进行二次分析，得出我们真实的性能需求。
　　对于初次上线的系统，我们需要使用同行的系统数据，进行用户行为分析和商业数据结构的估算为前提，利用性能估算法推算。得到的负荷和响应时间数据可以被应用于验证所计划的模型的能力，并帮助做出对策。
　　对于已经上线的系统，我们可以通过运维人员获取TPS和时间的比例分布图、用户数和时间的分布图、数据库ER关系图、容量数据等，直接精确得出目前系统的用户行为和业务数据关系，进而得出我们需要的性能需求。
(2)场景设计
(3)性能诊断调优
(4)环境搭建和模拟

重点关注点：
1 评估系统，需求分析
2 场景设计、用例设计
3 测试执行、是否通过
	判断是否通过测试关注点
		响应时间(RT)
		吞吐量(TPS)
		事务成功率
		硬件指标
			CPU
			内存
			存储
			网络
		稳定性
		内存有无泄漏
		其它
			数据库
			中间件
			缓存
			JVM
4 性能诊断优化
### 2．4　不同角色看性能　20
技术部门一般有下面几种角色：开发、测试、架构师、运维人员、（系统管理员、DBA）
（1）黑盒测试的角度
　　黑盒测试只关心应用程序的单步响应时间，性能好坏就看应用时间多少，也就是数据流经过服务器、服务器集群经过网络传输后往返的时间总和。
（2）开发角度
	1 架构合理性
	2 数据库设计合理性
	3 代码
	4 系统内存的使用方式
	5 系统线程使用方式
	6 系统资源是否有恶性，不合理竞争
（3）系统管理员角度
	1 硬件资源利用率
	2 JVM
	3 DB
	4 系统是否支持7*24的服务
	5 扩展性，兼容性，最大容量，可能的瓶颈
（4）性能测试的角度
	1 服务器硬件的性能
	2 根据需求和历史数据制定性能目标
	3 建立性能通过模型
	4 对开发代码框架和硬件框架进行性能分析
	5 针对开发发布版本的基准测试
	6 执行软件性能验收及稳定性测试
	7 生产环境的配置及优化
	8 制定性能测试的测试用例
	9 制定性能测试的场景设计
	10 协调各部门配合
	11 特定的性能分析

### 2．5　性能测试工具选择　21
### 2．6　性能测试相关术语　22
（1）负载：模拟业务操作对服务器造成压力的过程，比如模拟100个用户进行发帖。
（2）性能测试（Performance Testing）：模拟用户负载来测试系统在负载情况下，系统的响应时间，吞吐量等指标是否满足性能需求。
（3）负载测试（load Testing）：在一定软硬件环境下，通过不断加大负载（不同虚拟用户数）来确定在满足性能指标情况下能够承受的最大用户数。这些性能指标包括：TPS（每秒事务数）、RT（事务平均响应时间）、CPU using（CPU利用率）、MEM using（内存使用率）等软硬件指标。
（4）配置测试（Configuration Testing）：为了合理地调配资源，提高系统运行效率，通过测试手段来获取、验证、调整配置信息的过程。
（5）压力测试\强度测试（Stress Testing）：在一定软硬件环境下，通过高负载的手段来使服务器资源处于极限状态，测试系统在极限状态下长时间运行是否稳定，确定是否稳定的指示包括TPS、RT、CPU using、MEM using等。
（6）稳定性测试（Endurance Testing）：在一定软硬件环境下，长时间运行一定负载，确定系统在满足性能指标的前提下是否运行稳定。一般我们会在满足性能要求的负载情况下加大1.5倍-2倍的负载量进行测试。
（7）TPS：每秒完成的事务数，通常指每秒成功的事务数，性能测试中重要的综合性性能指标。一个事务是一个业务度量单位，有时一个事务会包括多个子操作，为了统计方便，会把着多个子操作记为一个事务。
（8）RT/ART（Response Time\average response time）:响应时间/平均响应时间，指一个事务花费多长时间完成，一般取平均响应时间。
（9）PV（page view）：每秒用户访问页面的次数，此参数用来分析平均每秒有多少用户访问页面。
（10）Vuser虚拟用户（Virtual user）：模拟真实业务逻辑步骤的虚拟用户，虚拟用户模拟的操作步骤都被记录在虚拟用户脚本里。Vuser脚本用语描述Vuser在场景中执行的操作。
（11）Concurrency并发，并发分为狭义和广义两类。狭义的并发，即所有用户在同一时刻作品同一件事情或者操作，或者所有用户进行完全一样的操作；广义的并发，即多个用户对系统发出了请求或进行了操作，但是这些请求或操作可以是不同的。
（12）场景（Scenario）：性能测试过程中为了模拟真实用户的业务处理过程，在loadrunner中构建的基于事务、脚本、虚拟用户、运行设置、运行计划、监控、分析等一系列动作的集合，称之为性能测试场景。场景中包含了待执行脚本、脚本组、并发用户数、负载生成器、测试目标、测试执行时的配置条件等。
（13）思考时间（Think Time）：模拟真实用户在实际操作时的停顿间隔时间。也就是说，用户在进行操作时，每个请求之间的间隔时间。
（14）标准差（Std. Deviation）：标准差越小，说明波动越小，系统越稳定。
### 2．7　性能测试通过标准　23
Web项目性能测试通过标准
┏━					┳			┳					┳				┳		┓
┃类别				┃判断维度		┃不通过				┃通过			┃备注	┃
┡					╀			╀					╀				╀──────	┩
│通用互联网服务端性能	├超时概率		┼大于 0.5‰			┼小于0.5‰		┼
│					├错误概率		┼大于 0.5‰			┼小于0.5‰		┤────────	┤
│					├TPS 		┼小于期望高峰值		┼大于期望高峰值	┤			│
│					├CPU利用率 	┼大于75%				┼小于75%			┤			│
│					├响应时间		┼大于期望时间			┼小于期望高峰值	┤			│
│					├Load 		┼平均每核CPU的Load大于1┼平均每核CPU的Load小于1┤		│
│					├JVM内存使用率┼大于80%				┼小于80%			┤			│
├──────────────────	├Full GC频率	┼平均小于半小时1次		┼平均大于半小时1次	┼			│
│前端页面性能			┼YSlow评定	┼YSlow评定为C级以下	┼	YSlow评定为C级，或C级以上	┤
└─					┴			┴					┴							┴
### 2．8　性能测试趋势　24
### 2．9　本章小节　24
性能测试工作是一个综合学科：对技术要求高、广，也要求具备一定沟通能力。
性能测试的工作过程中要注意的关键点也比较多，首先要做好性能需求分析，不充足的性能需求分析直接导致性能测试工具失败。接着要做好用例及场景设计，尽可能复现实际负载，这样的执行工作才是可信赖的，可参考的。执行过程要做好性能监控工作，为问题分析提供数据支撑。
## 工具篇
## 第3章　JMeter体系结构　25
### 3．1　JMeter简介　26
### 3．2　JMeter体系结构　26
#### 3．2．1　X1【取样器】　27
#### 3．2．2　X1【断言】　28
#### 3．2．3　X1【监听器】　28
#### 3．2．4　X2【前置处理器】　29
#### 3．2．5　X2【配置元件】　29
#### 3．2．6　X2【后置处理器】　30
#### 3．2．7　X3【控制器】　31
#### 3．2．8　X4【定时器】　31
#### 3．2．9　X5【线程组】　31
#### 3．2．10　Test Fragment　32
#### 3．2．11　工作台　32
### 3．3　JMeter运行原理　33
### 3．4　JMeter测试计划要素　34
### 3．5　JMeter环境介绍　35
### 3．6　JMeter与LoadRunner异同　37
### 3．7　本章小结　38
## 第4章　JMeter脚本开发　39
### 4．1　JMeter工作区介绍　40
### 4．2　JMeter Http协议录制　41
#### 4．2．1　Badboy进行录制　41
#### 4．2．2　JMeter配置代理进行录制　49
### 4．3　JMeter 脚本调试　52
### 4．4　JMeter 关联　55
#### 4．4．1　后置处理器　56
#### 4．4．2　Regular Expression Extractor　56
### 4．5　JMeter 参数化　60
#### 4．5．1　配置元件　60
#### 4．5．2　CSV Data Set Config　60
#### 4．5．3　函数助手　62
#### 4．5．4　访问地址参数化　64
#### 4．5．5　HTTP请求默认值　64
### 4．6　JMeter 检查点　65
#### 4．6．1　断言　65
#### 4．6．2　Response Assertion　66
### 4．7　JMeter事务　68
#### 4．7．1　逻辑控制器　68
#### 4．7．2　事务控制器　68
### 4．8　JMeter 集合点　69
#### 4．8．1　定时器　69
#### 4．8．2　同步定时器　69
### 4．9　JMeter元件运行顺序　70
### 4．10　本章小结　72
## 第5章　JMeter负载与监听　74
### 5．1　场景设计　75
### 5．2　场景设置　75
### 5．3　场景运行　77
#### 5．3．1　GUI运行　77
#### 5．3．2　非GUI运行测试　79
### 5．4　性能参数配置　82
### 5．5　测试监听　83
#### 5．5．1　JMeter监听器　83
#### 5．5．2　开源监听插件　85
### 5．6　本章小结　85
## 第6章　JMeter元件详解　86
### 6．1　逻辑控制器　87
#### 6．1．1　ForEach Controller（循环控制器）　87
#### 6．1．2　Simple Controller　89
#### 6．1．3　Include Controller　90
#### 6．1．4　Runtime Controller　90
#### 6．1．5　Switch Controller　91
#### 6．1．6　While Controller　91
#### 6．1．7　Interleave Controller　91
#### 6．1．8　Once Only Controller　92
#### 6．1．9　Throughput Controller　93
#### 6．1．10　If Controller　94
#### 6．1．11　Module Controller　94
#### 6．1．12　Random Controller　95
#### 6．1．13　Random Order Controller　95
#### 6．1．14　Loop Controller　96
#### 6．1．15　Recording Controller　96
#### 6．1．16　Transaction Controller　97
### 6．2　配置元件　98
#### 6．2．1　FTP请求默认值　98
#### 6．2．2　HTTP Authorization Manager　99
#### 6．2．3　HTTP Request Defaults　99
#### 6．2．4　Java Request Defaults　99
#### 6．2．5　JDBC Connection Configuration　100
#### 6．2．6　Random Variable　100
#### 6．2．7　Counter　100
#### 6．2．8　Login Config Element　101
### 6．3　定时器　101
#### 6．3．1　Gaussian Random Timer　102
#### 6．3．2　Constant Timer　102
#### 6．3．3　Synchronizing Timer　102
#### 6．3．4　Constant Throughput Timer　102
#### 6．3．5　Uniform Random Timer　103
#### 6．3．6　Poisson Random Timer　103
#### 6．3．7　BeanShell Timer　103
#### 6．3．8　BSF Timer　106
#### 6．3．9　JSR223 Timer　106
### 6．4　前置处理器　106
#### 6．4．1　BeanShell PreProcessor　106
#### 6．4．2　JSR223 PreProcessor　107
#### 6．4．3　BSF PreProcessor　108
#### 6．4．4　Regular User Parameter　108
#### 6．4．5　用户参数　110
#### 6．4．6　JDBC PreProcessor　110
#### 6．4．7　HTML链接解析器　111
#### 6．4．8　HTTP URL 重写修饰符　114
### 6．5　后置处理器　115
#### 6．5．1　Debug PostProcessor　115
#### 6．5．2　JDBC PostProcessor　116
#### 6．5．3　Result Status Action Handler　116
#### 6．5．4　XPath Extractor　117
### 6．6　断言　118
#### 6．6．1　BeanShell Assertion　118
#### 6．6．2　Compare Assertion　120
#### 6．6．3　HTML Assertion　120
#### 6．6．4　Size Assertion　121
#### 6．6．5　XML Schema Assertion　122
#### 6．6．6　XML Assertion　123
#### 6．6．7　XPath Assertion　123
#### 6．6．8　Duration Assertion　124
#### 6．6．9　其他断言元件　124
### 6．7　监听器　124
#### 6．7．1　监听器默认配置　124
#### 6．7．2　Aggregate Graph　127
#### 6．7．3　BeanShell Listener（BeanShell监听器）　130
#### 6．7．4　Distribution Graph（分布图）　130
#### 6．7．5　Response Time Graph（响应时间图形监听器）　131
#### 6．7．6　Simple Data Writer　131
#### 6．7．7　Spline Visualizer（样条线显示取样器）　132
#### 6．7．8　Summary Report（表格形式显示）　133
#### 6．7．9　Save Response to a file（存储服务器响应）　133
#### 6．7．10　View Results Tree（察看结果树）　134
#### 6．7．11　Assertion Results（断言结果）　135
#### 6．7．12　Generate Summary Results（窗口显示结果）　136
#### 6．7．13　View Results in Table（表格形式显示）　136
#### 6．7．14　Monitor Results　137
#### 6．7．15　Aggregate Report　138
#### 6．7．16　Mailer Visualizer　138
### 6．8　函数助手　139
#### 6．8．1　__BeanShell脚本语言　139
#### 6．8．2　__char　140
#### 6．8．3　__counter　141
#### 6．8．4　__CSVRead　142
#### 6．8．5　__escapeHtml　143
#### 6．8．6　__escapeOroRegexChars　143
#### 6．8．7　__eval　144
#### 6．8．8　__evalVar　144
#### 6．8．9　__FileToString　145
#### 6．8．10　__intSum　146
#### 6．8．11　__longSum　146
#### 6．8．12　__javaScript　146
#### 6．8．13　__jexl　146
#### 6．8．14　__log　147
#### 6．8．15　__logn　148
#### 6．8．16　__machineIP　148
#### 6．8．17　__machineName　149
#### 6．8．18　__P　149
#### 6．8．19　__property　149
#### 6．8．20　__Random　150
#### 6．8．21　__RandomString　150
#### 6．8．22　__regexFunction　151
#### 6．8．23　__samplerName　151
#### 6．8．24　__setProperty　152
#### 6．8．25　__split　152
#### 6．8．26　__StringFromFile　153
#### 6．8．27　__TestPlanName　154
#### 6．8．28　__threadNum　154
#### 6．8．29　__time　154
#### 6．8．30　__unescape　155
#### 6．8．31　__unescapeHtml　155
#### 6．8．32　__urldecode　155
#### 6．8．33　__urlencode　155
#### 6．8．34　__UUID　155
#### 6．8．35　__V　155
#### 6．8．36　__XPath　156
### 6．9　本章小结　156
## 第7章　JMeter常用脚本开发　158
### 7．1　BeanShell Sampler　159
### 7．2　Debug Sampler　162
### 7．3　FTP请求　163
### 7．4　Java请求　164
### 7．5　JDBC请求　171
#### 7．5．1　JDBC连接池设置　172
#### 7．5．2　添加JDBC Request　174
### 7．6　JUnit Request　179
#### 7．6．1　JUnit简介　179
#### 7．6．2　JUnit参数　180
#### 7．6．3　JMeter JUnit Request　181
### 7．7　SOAP/XML-RPC Request　182
### 7．8　本章小结　184
## 第8章　JMeter开源测试组件　185
### 8．1　线程组　187
#### 8．1．1　Ultimate Thread Group　187
#### 8．1．2　Stepping Thread Group　188
### 8．2　逻辑控制器　189
### 8．3　配置元件　190
### 8．4　定时器　190
### 8．5　监听器　191
#### 8．5．1　Transactions per Second　191
#### 8．5．2　Response Times Over Time　192
#### 8．5．3　Response Times vs Threads　192
#### 8．5．4　Graphs Generator　192
### 8．6　服务器监控　193
### 8．7　本章小结　195
## 实战篇
## 第9章　性能监控诊断　196
### 9．1　操作系统性能分析介绍　197
### 9．2　系统性能分析思路　198
#### 9．2．1　系统性能分析因素-CPU　199
#### 9．2．2　系统性能分析因素-内存　199
#### 9．2．3　系统性能分析因素-网络　200
#### 9．2．4　系统性能分析因素-I/O　201
#### 9．2．5　系统性能分析因素-总结　201
### 9．3　瓶颈阈值分析思维导图与手册　202
#### 9．3．1　CPU定位分析　202
#### 9．3．2　内存定位分析　203
#### 9．3．3　网络定位分析　203
#### 9．3．4　IO定位分析　204
### 9．4　Linux系统性能分析思路和实践　204
#### 9．4．1　系统负载监控分析实践　205
#### 9．4．2　系统监控分析实践　206
### 9．5　Windows系统性能分析思路和实践　217
#### 9．5．1　性能监视器综述　217
#### 9．5．2　性能监视器工具介绍　218
#### 9．5．3　系统监控分析实践　218
#### 9．5．4　资源监视器介绍和实践　226
### 9．6　Tomcat监控之Probe　235
### 9．7　MySQL监控之MONyog　238
### 9．8　JVM监控　241
#### 9．8．1　jps　241
#### 9．8．2　jstat　243
#### 9．8．3　jmap　245
#### 9．8．4　JVisualVM　247
### 9．9　本章小结　250
## 第10章　性能分析调优　251
### 10．1　性能分析方法　253
### 10．2　单机性能分析与调优　254
#### 10．2．1　性能分析流程　254
#### 10．2．2　系统性能关注点　256
#### 10．2．3　程序优化　261
#### 10．2．4　配置优化　263
#### 10．2．5　数据库连接池优化　263
#### 10．2．6　线程优化　265
#### 10．2．7　DB优化　268
### 10．3　业务流程优化　269
### 10．4　结构优化　269
#### 10．4．1　单机结构　269
#### 10．4．2　集群结构　270
#### 10．4．3　分布式结构　271
### 10．5　本章小结　277
## 第11章　综合实践之诊断分析与调优　278
### 11．1　需求分析　280
#### 11．1．1　需求采集　282
#### 11．1．2　需求分析　285
#### 11．1．3　并发数计算　289
### 11．2　测试模型　291
### 11．3　测试计划　291
### 11．4　环境搭建　292
### 11．5　脚本开发　295
#### 11．5．1　浏览帖子　295
#### 11．5．2　回复帖子　298
#### 11．5．3　发帖　301
### 11．6　数据准备　301
#### 11．6．1　主数据准备　302
#### 11．6．2　数据制作方法　303
### 11．7　场景设计　307
#### 11．7．1　场景设计　307
#### 11．7．2　场景实现　309
### 11．8　测试监控　312
### 11．9　测试执行　313
#### 11．9．1　基准测试　313
#### 11．9．2　配置测试　315
#### 11．9．3　负载测试　319
#### 11．9．4　稳定性测试　327
### 11．10　结果分析　328
### 11．11　测试报告　329
### 11．12　本章小结　330
## 提升篇
## 第12章　互联网测试必备知识——HTTP协议　331
### 12．1　HTTP协议简介　332
### 12．2　HTTP工作原理　332
### 12．3　HTTP请求　333
### 12．4　HTTP应答　335
### 12．5　HTTP捕获　336
### 12．6　Http Watch　337
### 12．6．1　HttpWatch录制　337
### 12．6．2　HttpWatch数据分析　338
### 12．7　本章小结　341
## 第13章　端到端性能监控平台　342
### 13．1　为什么构建基于云的端到端性能监控平台　343
### 13．2　端到端监控的意义　343
### 13．3　前端监控常见策略　343
### 13．4　基于httpWatch的自动捕获　344
### 13．5　基于firebug的自动捕获　345
#### 13．5．1　自动导出瀑布图　345
#### 13．5．2　HARViewer部署　346
#### 13．5．3　基于Fiddler的自动捕获　348
#### 13．5．4　基于YSlow的前端评估体系　348
#### 13．5．5　基于PageSpeed的前端评估体系　350
#### 13．5．6　基于dynaTrace Ajax的前端评估体系　351
### 13．6　构建基于Showslow的监控体系　356
#### 13．6．1　Showslow介绍　356
#### 13．6．2　Showslow环境搭建　356
#### 13．6．3　ShowSlow配置　357
#### 13．6．4　YSlow配置　357
#### 13．6．5　WebDriver驱动的定时监控体系　359
### 13．7　本章小结　361
## 第14章　性能测试自动化——Jenkins+Ant+　JMeter　362
### 14．1　为什么要做性能测试自动化　363
### 14．2　如何做性能测试自动化　365
### 14．3　Ant+JMeter集成　365
#### 14．3．1　Ant下载　366
#### 14．3．2　Ant安装　366
#### 14．3．3　JMeter中配置XML文件来定义测试活动　367
#### 14．3．4　运行测试计划　369
### 14．4　Jenkins+Ant集成　371
#### 14．4．1　Jenkins安装　372
#### 14．4．2　建立Slave节点　374
#### 14．4．3　JMeter任务配置　377
### 14．5　如何运行复杂场景　385
### 14．6　报告自动化　385
#### 14．6．1　配置TPS、响应时间等图表　385
#### 14．6．2　报告合成　386
### 14．7　JMeter脚本拷贝自动化　391
### 14．8　JMeter Agent自动化　395
### 14．9　本章小结　398
## 第15章　JMeter常见问题　399
### 15．1　JMeter无法开启　400
### 15．2　JMeter异常关闭　400
### 15．3　JMeter无法产生负载　401
### 15．4　JMeter日志输出控制　401
### 15．5　记录测试结果影响Jmeter效率　402
### 15．6　JMeter可以测试接口吗　402
### 15．7　JMeter可以测试Dubbo接口吗　403
### 15．8　JMeter可以测试RPC接口吗　404
### 15．9　JMeter函数助手中函数不够用怎么办　404
### 15．10　JMeter支持子事务的定义吗　407
### 15．11　JMeter非GUI方式运行时如何传递运行参数　408
### 15．12　运行场景时察看结果树为什么要关闭　409
### 15．13　多个测试计划如何运行　409
### 15．14　如何找导致CPU瓶颈的程序　410
### 15．15　如何找导致内存瓶颈的程序　410
### 15．16　如何找导致IO瓶颈的程序　411
### 15．17　如何计算并发用户数　411
### 15．18　JMeter可以做哪些测试　412
### 15．19　性能测试的分析方法有哪些　412
### 15．20　如何看懂Java线程栈信息　413
### 15．21　能用本地负载环境测试“云环境”的性能吗　413
### 15．22　性能测试环境和生产环境不一致　414
### 15．23　本章小结　414
## 附录A　Jforum性能测试计划　415
### A．1　性能测试背景　416
### A．2　性能测试目标　416
### A．3　性能测试范围　416
### A．4　名词术语约定　416
### A．5　测试环境　417
#### A．5．1　生产环境系统架构　417
#### A．5．2　测试环境系统架构　418
#### A．5．3　生产环境软硬件配置　418
#### A．5．4　测试环境软硬件配置　419
#### A．5．5　负载机软硬件配置　419
### A．6　需求分析　420
#### A．6．1　业务模型　420
#### A．6．2　性能指标　421
### A．7　测试策略　422
#### A．7．1　测试执行策略　422
#### A．7．2　测试监控策略　422
### A．8　测试场景　423
### A．9　测试准备　423
#### A．9．1　测试工具准备　424
#### A．9．2　测试脚本及程序准备　424
#### A．9．3　测试数据准备　424
#### A．9．4　测试环境准备　424
### A．10　测试组织架构　425
### A．11　交付清单　425
### A．12　项目风险　426
### A．13　附录　426
## 附录B　性能测试报告　427
### B．1　性能测试背景　428
### B．2　性能测试目标　428
### B．3　性能测试范围　428
### B．4　名词术语约定　429
### B．5　测试环境　430
#### B．5．1　生产环境系统架构　430
#### B．5．2　测试环境系统架构　430
#### B．5．3　生产环境软硬件配置　431
#### B．5．4　测试环境软硬件配置　431
#### B．5．5　负载机软硬件配置　431
### B．6　测试数据　432
#### B．6．1　历史数据量　432
#### B．6．2　主数据　432
#### B．6．3　性能指标　432
### B．7　测试进度　433
### B．8　测试结果　433
#### B．8．1　基准测试结果　433
#### B．8．2　配置测试　434
#### B．8．3　负载测试结果　438
#### B．8．4　稳定性测试结果　445
### B．9　测试结论　447
#### B．9．1　测试结论　447
#### B．9．2　系统缺陷　448
### B．10　系统风险　448
## 参考资料　449
